# Line Detection Configuration File
# This file contains all configurable parameters for the straight line detection
# and path planning using Hough transform algorithm.

# Hough Transform Parameters
hough:
  # Resolution for rho (distance from origin) in meters
  rho_resolution: 0.1  # [m]

  # Resolution for theta (angle) in radians
  theta_resolution: 0.01  # [rad]

  # Minimum number of votes to consider a line valid
  min_votes: 3  # [-]

  # Tolerance for theta angle when selecting parallel boundary lines (radians)
  theta_tolerance: 0.2  # [rad]

  # Minimum rho difference between two boundary lines (meters)
  min_rho_diff: 2.0  # [m]

  # Maximum rho difference between two boundary lines (meters)
  max_rho_diff: 20.0  # [m]

  # Maximum number of lines to check for boundary pairs
  max_lines_to_check: 10  # [-]

# Cone Filtering Parameters
cones:
  # Maximum cone distance to consider from vehicle (meters)
  max_distance: 50.0  # [m]

  # Minimum cone distance to consider from vehicle (meters)
  min_distance: 2.0  # [m]

  # Maximum lateral (Y-axis) distance for cone filtering (meters)
  max_lateral_distance: 10.0  # [m]

  # Minimum valid cones for sparse fallback
  min_valid_count: 2  # [-]

  # Hold last valid path when cones are temporarily sparse
  hold_on_sparse_cones: true  # [-]

# Path Generation Parameters
path:
  # Interval between path points (meters)
  interval: 0.1  # [m]

  # Total path distance for acceleration + braking (meters)
  max_distance: 150.0  # [m]

  # Starting X position for path generation (meters)
  start_x: 1.0  # [m]

  # ACC segment lengths (meters)
  accel_distance: 75.0  # [m]
  brake_distance: 100.0  # [m]

# Vehicle Parameters
vehicle:
  # IMU to lidar offset in x direction (meters)
  # Used for coordinate transformation from vehicle to world frame
  imu_offset_x: 1.87  # [m]  — 与 localization/lidarToIMUDist 统一

# Finish Line Detection
finish:
  # Distance threshold for detecting finish line (meters)
  # When vehicle reaches within this distance of the finish line,
  # the finish signal is published
  threshold: 2.0  # [m]

# Topic Names
topics:
  # Cone position topic from perception module
  cone: "perception/lidar_cluster/detections"

  # Vehicle state topic from localization
  car_state: "localization/car_state"

  # Planned path output topic
  path: "planning/line_detection/path"

  # PathLimits output topic (P1)
  pathlimits: "planning/pathlimits"

  # Finish signal output topic
  finish: "planning/line_detection/finish_signal"

frames:
  expected_cone: "velodyne"
  output: "world"

# Speed profile for PathLimits (P1)
speed:
  # SAFE speed cap (m/s)
  speed_cap: 20.0  # [m/s]
  max_lateral_acc: 6.5  # [m/s^2]
  max_accel: 3.0  # [m/s^2]
  max_brake: 4.0  # [m/s^2]
  min_speed: 1.0  # [m/s]
  curvature_epsilon: 0.001  # [1/m]
  accel_zone_length: 75.0  # [m]
  brake_zone_length: 100.0  # [m]
  timing_start_offset: 0.3  # [m]
