# ==========================================================
# Skidpad Control Overlay (八字绕环控制参数)
# ==========================================================
# 加载顺序: param.yaml → 本文件
#
# 【赛事特点】
#   - 中速运动（5-8 m/s）
#   - 连续圆环，高侧向加速度
#   - 大滑移角（drift）
#
# 【调参策略】
#   - 短lookahead距离（1.5-5m）
#   - ⭐ 强滑移角补偿（0.7）
#   - 使用st控制器（Special Track）
# ==========================================================

# ⭐ 使用st控制器（不是pp）
# 原因：八字绕环有专门的控制逻辑
st:
  # PID参数
  angle_kv: 0.5
  angle_kl: 2.5
  angle_kp: 0.9
  angle_ki: 0.0
  angle_kd: 0.0
  
  # 最大转向角速度
  # 八字绕环需要快速转向响应
  steering_delta_max: 0.5
  
  # ==========================
  # 滑移角补偿 ⭐关键参数
  # ==========================
  enable_slip_compensation: true
  
  # ⭐ 八字绕环需要更强的补偿
  # 原因：圆环运动产生大滑移角（轮胎侧滑）
  # 如果不补偿：车辆会understeer（转向不足）
  # 建议范围: 0.6-0.8
  slip_gain: 0.7
  
  # ==========================
  # Lookahead距离
  # ==========================
  # ⭐ 短前瞻距离
  # 原因：
  #   1. 需要精确跟踪圆环路径
  #   2. 圆环曲率大，长lookahead会cut corner
  #   3. 中速运动不需要太长lookahead
  min_lookahead: 1.5
  max_lookahead: 5.0

# ==========================
# 【调参指南 - Skidpad】
# ==========================
#
# 1. 如圆环跟踪偏差大（车辆不沿圆弧）：
#    - ⭐ 增大 slip_gain (0.7→0.8)
#    - 减小 max_lookahead (5→4)
#    - 检查 cg_to_front/cg_to_rear 是否准确
#
# 2. 如八字交叉点（两个圆环交界处）转向不及时：
#    - 增大 steering_delta_max (0.5→0.6)
#    - 稍微增大 angle_kp (0.9→0.95)
#
# 3. 如车辆抖动（oscillation）：
#    - 减小 angle_kp (0.9→0.8)
#    - 增大 min_lookahead (1.5→1.8)
#
# 4. 如冲出圆环（understeer严重）：
#    - ⭐ 显著增大 slip_gain (0.7→0.8)
#    - 检查轮胎抓地力（胎压、温度）
#    - 降低速度（修改 skidpad_detection.yaml）
#
# 5. 如圆环内侧轮胎离地（oversteer）：
#    - 减小 slip_gain (0.7→0.6)
#    - 检查重心高度参数
#
# 【特别注意事项】
#   - slip_gain 是八字绕环的关键参数
#   - 不同轮胎/地面条件可能需要不同值
#   - 建议在场地上做几次测试圈微调
#
# 【观测信号】
#   # 监控滑移角补偿效果
#   rostopic echo /vehcileCMDMsg | grep delta
#   # 对比实际航向和路径切线方向
#   # RViz中观察是否沿圆环行驶
#
# 【相关配置文件】
#   - skidpad_detection.yaml: 圆环几何参数
#   - planning_ros/config/skidpad_detection.yaml
